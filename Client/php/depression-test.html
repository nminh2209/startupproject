<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="/Client/css/depression-design.css" media="screen" rel="stylesheet" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Bài kiểm tra trầm cảm - PsychHealth</title>
    <style>
        /* CSS của bạn ở đây */
    </style>
</head>
<body>
<section class="navigation-bar">
    <nav class="navbar">
        <div class="brand-div">
            <p class="brand-name"><a href="index.html">PsychHealth</a></p>
        </div>
        <div class="nav-options">
            <ul class="nav-links">
                <li><a href="index.html">Trang Chủ</a></li>
                <li><a href="about.html">Giới Thiệu</a></li>
                <li><a href="test.html">Bài Kiểm Tra</a></li>
                <li><a href="FAQ.html">Câu Hỏi Thường Gặp</a></li>
            </ul>
        </div>
    </nav>
</section>
<div class="flex-div">
    <div class="container">
        <h1>Bài Kiểm Tra Trầm Cảm (PHQ-9))</h1>
        <form id="depressionForm">
            <label for="question1">1. Bạn có thấy ít hứng thú hoặc vui vẻ khi làm các hoạt động hàng ngày không?</label>
            <div class="radio-group">
                <input id="q1-option1" name="question1" required type="radio" value="0">
                <label for="q1-option1">Không</label>

                <input id="q1-option2" name="question1" type="radio" value="1">
                <label for="q1-option2">Thỉnh thoảng</label>

                <input id="q1-option3" name="question1" type="radio" value="2">
                <label for="q1-option3">Thường xuyên</label>

                <input id="q1-option4" name="question1" type="radio" value="3">
                <label for="q1-option4">Luôn luôn</label>
            </div>

            <label for="question2">2. Bạn có cảm thấy buồn, chán nản hoặc mất hy vọng không?</label>
            <div class="radio-group">
                <input id="q2-option1" name="question2" required type="radio" value="0">
                <label for="q2-option1">Không</label>

                <input id="q2-option2" name="question2" type="radio" value="1">
                <label for="q2-option2">Thỉnh thoảng</label>

                <input id="q2-option3" name="question2" type="radio" value="2">
                <label for="q2-option3">Thường xuyên</label>

                <input id="q2-option4" name="question2" type="radio" value="3">
                <label for="q2-option4">Luôn luôn</label>
            </div>

            <label for="question3">3. Bạn có gặp khó khăn khi ngủ, ngủ quá nhiều hoặc không ngủ được không?</label>
            <div class="radio-group">
                <input id="q3-option1" name="question3" required type="radio" value="0">
                <label for="q3-option1">Không</label>

                <input id="q3-option2" name="question3" type="radio" value="1">
                <label for="q3-option2">Thỉnh thoảng</label>

                <input id="q3-option3" name="question3" type="radio" value="2">
                <label for="q3-option3">Thường xuyên</label>

                <input id="q3-option4" name="question3" type="radio" value="3">
                <label for="q3-option4">Luôn luôn</label>
            </div>
            <label for="question4">4. Bạn có cảm giác mệt mỏi hoặc thiếu năng lượng không?</label>
            <div class="radio-group">
                <input id="q4-option1" name="question4" required type="radio" value="0">
                <label for="q4-option1">Không</label>

                <input id="q4-option2" name="question4" type="radio" value="1">
                <label for="q4-option2">Thỉnh thoảng</label>

                <input id="q4-option3" name="question4" type="radio" value="2">
                <label for="q4-option3">Thường xuyên</label>

                <input id="q4-option4" name="question4" type="radio" value="3">
                <label for="q4-option4">Luôn luôn</label>
            </div>

            <label for="question5">5. Bạn có thấy chán ăn hoặc ăn quá nhiều không?</label>
            <div class="radio-group">
                <input id="q5-option1" name="question5" required type="radio" value="0">
                <label for="q5-option1">Không</label>

                <input id="q5-option2" name="question5" type="radio" value="1">
                <label for="q5-option2">Thỉnh thoảng</label>

                <input id="q5-option3" name="question5" type="radio" value="2">
                <label for="q5-option3">Thường xuyên</label>

                <input id="q5-option4" name="question5" type="radio" value="3">
                <label for="q5-option4">Luôn luôn</label>
            </div>

            <label for="question3">6. Bạn có cảm thấy không hài lòng về bản thân hoặc nghĩ rằng mình thất bại không?</label>
            <div class="radio-group">
                <input id="q6-option1" name="question3" required type="radio" value="0">
                <label for="q6-option1">Không</label>

                <input id="q6-option2" name="question3" type="radio" value="1">
                <label for="q6-option2">Thỉnh thoảng</label>

                <input id="q6-option3" name="question6" type="radio" value="2">
                <label for="q6-option3">Thường xuyên</label>

                <input id="q6-option4" name="question6" type="radio" value="3">
                <label for="q6-option4">Luôn luôn</label>
            </div>

            <label for="question7">7. Bạn có gặp khó khăn trong việc tập trung vào công việc hoặc sinh hoạt hàng ngày không?</label>
            <div class="radio-group">
                <input id="q7-option1" name="question7" required type="radio" value="0">
                <label for="q7-option1">Không</label>

                <input id="q7-option2" name="question7" type="radio" value="1">
                <label for="q7-option2">Thỉnh thoảng</label>

                <input id="q7-option3" name="question7" type="radio" value="2">
                <label for="q7-option3">Thường xuyên</label>

                <input id="q7-option4" name="question7" type="radio" value="3">
                <label for="q7-option4">Luôn luôn</label>
            </div>

            <label for="question8">8. Bạn có di chuyển hoặc nói chậm hơn thường ngày, hoặc ngược lại cảm thấy bồn chồn không</label>
            <div class="radio-group">
                <input id="q8-option1" name="question8" required type="radio" value="0">
                <label for="q8-option1">Không</label>

                <input id="q8-option2" name="question8" type="radio" value="1">
                <label for="q8-option2">Thỉnh thoảng</label>

                <input id="q8-option3" name="question8" type="radio" value="2">
                <label for="q8-option3">Thường xuyên</label>

                <input id="q8-option4" name="question8" type="radio" value="3">
                <label for="q8-option4">Luôn luôn</label>
            </div>

            <label for="question9">9. Bạn có suy nghĩ rằng mình sẽ tốt hơn nếu chết đi, hoặc có ý định làm tổn thương bản thân không?</label>
            <div class="radio-group">
                <input id="q9-option1" name="question9" required type="radio" value="0">
                <label for="q9-option1">Không</label>

                <input id="q9-option2" name="question9" type="radio" value="1">
                <label for="q9-option2">Thỉnh thoảng</label>

                <input id="q9-option3" name="question9" type="radio" value="2">
                <label for="q9-option3">Thường xuyên</label>

                <input id="q9-option4" name="question9" type="radio" value="3">
                <label for="q9-option4">Luôn luôn</label>
            </div>



            <button onclick="calculateDepression()" type="button">Nộp Bài</button>
        </form>

        <!-- Hiển thị kết quả -->
        <div id="resultContainer"></div>
    </div>
</div>

<script>
    function calculateDepression() {
    const questions = [
        "question1", "question2", "question3", "question4", 
        "question5", "question6", "question7", "question8", "question9"
    ];
    
    let totalScore = 0;
    let scores = [];
    let labels = [
        "Hứng thú hoạt động",
        "Tâm trạng buồn chán",
        "Vấn đề giấc ngủ",
        "Mệt mỏi",
        "Thói quen ăn uống",
        "Tự đánh giá bản thân",
        "Khả năng tập trung",
        "Vận động",
        "Ý nghĩ tiêu cực"
    ];

    // Collect scores
    questions.forEach((question, index) => {
        const selectedOption = document.querySelector(`input[name="${question}"]:checked`);
        if (selectedOption) {
            const score = parseInt(selectedOption.value, 10);
            totalScore += score;
            scores.push(score);
        }
    });

    // Create canvas for chart
    const chartHtml = '<canvas id="depressionChart" width="400" height="200"></canvas>';

    // Determine depression level
    let depressionLevel = "";
    if (totalScore >= 0 && totalScore <= 3) {
        depressionLevel = "Không có triệu chứng trầm cảm";
    } else if (totalScore >= 4 && totalScore <= 9) {
        depressionLevel = "Trầm cảm nhẹ";
    } else if (totalScore >= 10 && totalScore <= 13) {
        depressionLevel = "Trầm cảm trung bình";
    } else if (totalScore >= 14 && totalScore <= 18) {
        depressionLevel = "Trầm cảm nặng vừa";
    } else {
        depressionLevel = "Trầm cảm nghiêm trọng";
    }

    // Display results with chart
    Swal.fire({
        title: 'Kết Quả Bài Kiểm Tra Trầm Cảm',
        html: `
            <div style="margin-bottom: 20px;">
                <h3>Tổng điểm: ${totalScore}</h3>
                <h3>Mức độ: ${depressionLevel}</h3>
            </div>
            ${chartHtml}
        `,
        width: 800,
        confirmButtonText: 'Đóng',
        didRender: () => {
            const ctx = document.getElementById('depressionChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Điểm số từng câu hỏi',
                        data: scores,
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 3,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true
                        }
                    }
                }
            });
        }
    });
}
</script>
</body>
</html>
